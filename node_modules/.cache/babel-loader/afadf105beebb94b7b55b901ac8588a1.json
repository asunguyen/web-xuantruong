{"remainingRequest":"D:\\code\\DU_AN\\web-xuantruong\\web\\node_modules\\babel-loader\\lib\\index.js!D:\\code\\DU_AN\\web-xuantruong\\web\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\code\\DU_AN\\web-xuantruong\\web\\src\\permission.js","dependencies":[{"path":"D:\\code\\DU_AN\\web-xuantruong\\web\\src\\permission.js","mtime":1700281250031},{"path":"D:\\code\\DU_AN\\web-xuantruong\\web\\babel.config.js","mtime":1700281249910},{"path":"D:\\code\\DU_AN\\web-xuantruong\\web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1700281618382},{"path":"D:\\code\\DU_AN\\web-xuantruong\\web\\node_modules\\babel-loader\\lib\\index.js","mtime":1700281625119},{"path":"D:\\code\\DU_AN\\web-xuantruong\\web\\node_modules\\eslint-loader\\index.js","mtime":1700281619870}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9yZWdlbmVyYXRvclJ1bnRpbWUgZnJvbSAiRDovY29kZS9EVV9BTi93ZWIteHVhbnRydW9uZy93ZWIvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3JlZ2VuZXJhdG9yUnVudGltZS5qcyI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICJEOi9jb2RlL0RVX0FOL3dlYi14dWFudHJ1b25nL3dlYi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmNsdWRlcy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pbmNsdWRlcy5qcyI7CmltcG9ydCByb3V0ZXIgZnJvbSAiLi9yb3V0ZXIiOwppbXBvcnQgc3RvcmUgZnJvbSAiLi9zdG9yZSI7CmltcG9ydCB7IE1lc3NhZ2UgfSBmcm9tICJlbGVtZW50LXVpIjsKaW1wb3J0IE5Qcm9ncmVzcyBmcm9tICJucHJvZ3Jlc3MiOyAvLyBwcm9ncmVzcyBiYXIKaW1wb3J0ICJucHJvZ3Jlc3MvbnByb2dyZXNzLmNzcyI7IC8vIHByb2dyZXNzIGJhciBzdHlsZQppbXBvcnQgeyBnZXRUb2tlbiB9IGZyb20gIkAvdXRpbHMvYXV0aCI7IC8vIGdldCB0b2tlbiBmcm9tIGNvb2tpZQppbXBvcnQgZ2V0UGFnZVRpdGxlIGZyb20gIkAvdXRpbHMvZ2V0LXBhZ2UtdGl0bGUiOwpOUHJvZ3Jlc3MuY29uZmlndXJlKHsKICBzaG93U3Bpbm5lcjogZmFsc2UKfSk7IC8vIE5Qcm9ncmVzcyBDb25maWd1cmF0aW9uCgp2YXIgd2hpdGVMaXN0ID0gWyIvbG9naW4iXTsgLy8gbm8gcmVkaXJlY3Qgd2hpdGVsaXN0Cgpyb3V0ZXIuYmVmb3JlRWFjaCggLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICB2YXIgX3JlZiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSh0bywgZnJvbSwgbmV4dCkgewogICAgdmFyIGhhc1Rva2VuLCBoYXNHZXRVc2VySW5mbzsKICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgIGNhc2UgMDoKICAgICAgICAgIC8vIHN0YXJ0IHByb2dyZXNzIGJhcgogICAgICAgICAgTlByb2dyZXNzLnN0YXJ0KCk7CgogICAgICAgICAgLy8gc2V0IHBhZ2UgdGl0bGUKICAgICAgICAgIGRvY3VtZW50LnRpdGxlID0gZ2V0UGFnZVRpdGxlKHRvLm1ldGEudGl0bGUpOwoKICAgICAgICAgIC8vIGRldGVybWluZSB3aGV0aGVyIHRoZSB1c2VyIGhhcyBsb2dnZWQgaW4KICAgICAgICAgIGhhc1Rva2VuID0gZ2V0VG9rZW4oKTsKICAgICAgICAgIGlmICghaGFzVG9rZW4pIHsKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI5OwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICAgIGlmICghKHRvLnBhdGggPT09ICIvbG9naW4iKSkgewogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gOTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgICAvLyBpZiBpcyBsb2dnZWQgaW4sIHJlZGlyZWN0IHRvIHRoZSBob21lIHBhZ2UKICAgICAgICAgIG5leHQoewogICAgICAgICAgICBwYXRoOiAiLyIKICAgICAgICAgIH0pOwogICAgICAgICAgTlByb2dyZXNzLmRvbmUoKTsKICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyNzsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgOToKICAgICAgICAgIGhhc0dldFVzZXJJbmZvID0gc3RvcmUuZ2V0dGVycy5uYW1lOwogICAgICAgICAgaWYgKCFoYXNHZXRVc2VySW5mbykgewogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTQ7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgICAgbmV4dCgpOwogICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI3OwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAxNDoKICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAxNDsKICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxNzsKICAgICAgICAgIHJldHVybiBzdG9yZS5kaXNwYXRjaCgidXNlci9nZXRJbmZvIik7CiAgICAgICAgY2FzZSAxNzoKICAgICAgICAgIG5leHQoKTsKICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyNzsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMjA6CiAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMjA7CiAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDE0KTsKICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyNDsKICAgICAgICAgIHJldHVybiBzdG9yZS5kaXNwYXRjaCgidXNlci9yZXNldFRva2VuIik7CiAgICAgICAgY2FzZSAyNDoKICAgICAgICAgIE1lc3NhZ2UuZXJyb3IoX2NvbnRleHQudDAgfHwgIkhhcyBFcnJvciIpOwogICAgICAgICAgbmV4dCgiL2xvZ2luP3JlZGlyZWN0PSIuY29uY2F0KHRvLnBhdGgpKTsKICAgICAgICAgIE5Qcm9ncmVzcy5kb25lKCk7CiAgICAgICAgY2FzZSAyNzoKICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzMDsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMjk6CiAgICAgICAgICAvKiBoYXMgbm8gdG9rZW4qLwoKICAgICAgICAgIC8vIGlmICh3aGl0ZUxpc3QuaW5kZXhPZih0by5wYXRoKSAhPT0gLTEpIHsKICAgICAgICAgIC8vICAgLy8gaW4gdGhlIGZyZWUgbG9naW4gd2hpdGVsaXN0LCBnbyBkaXJlY3RseQogICAgICAgICAgLy8gICBuZXh0KCkKICAgICAgICAgIC8vIH0gZWxzZSB7CiAgICAgICAgICAvLyAgIC8vIG90aGVyIHBhZ2VzIHRoYXQgZG8gbm90IGhhdmUgcGVybWlzc2lvbiB0byBhY2Nlc3MgYXJlIHJlZGlyZWN0ZWQgdG8gdGhlIGxvZ2luIHBhZ2UuCiAgICAgICAgICAvLyAgIG5leHQoYC9sb2dpbj9yZWRpcmVjdD0ke3RvLnBhdGh9YCkKICAgICAgICAgIC8vICAgTlByb2dyZXNzLmRvbmUoKQogICAgICAgICAgLy8gfQogICAgICAgICAgaWYgKHRvLnBhdGguaW5jbHVkZXMoIi9hZG1pbiIpKSB7CiAgICAgICAgICAgIG5leHQoIi9sb2dpbj9yZWRpcmVjdD0iLmNvbmNhdCh0by5wYXRoKSk7CiAgICAgICAgICAgIE5Qcm9ncmVzcy5kb25lKCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuZXh0KCk7CiAgICAgICAgICB9CiAgICAgICAgY2FzZSAzMDoKICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgfQogICAgfSwgX2NhbGxlZSwgbnVsbCwgW1sxNCwgMjBdXSk7CiAgfSkpOwogIHJldHVybiBmdW5jdGlvbiAoX3gsIF94MiwgX3gzKSB7CiAgICByZXR1cm4gX3JlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogIH07Cn0oKSk7CnJvdXRlci5hZnRlckVhY2goZnVuY3Rpb24gKCkgewogIC8vIGZpbmlzaCBwcm9ncmVzcyBiYXIKICBOUHJvZ3Jlc3MuZG9uZSgpOwp9KTs="},{"version":3,"names":["router","store","Message","NProgress","getToken","getPageTitle","configure","showSpinner","whiteList","beforeEach","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","to","from","next","hasToken","hasGetUserInfo","wrap","_callee$","_context","prev","start","document","title","meta","path","done","getters","name","dispatch","t0","error","concat","includes","stop","_x","_x2","_x3","apply","arguments","afterEach"],"sources":["D:/code/DU_AN/web-xuantruong/web/src/permission.js"],"sourcesContent":["import router from \"./router\";\r\nimport store from \"./store\";\r\nimport { Message } from \"element-ui\";\r\nimport NProgress from \"nprogress\"; // progress bar\r\nimport \"nprogress/nprogress.css\"; // progress bar style\r\nimport { getToken } from \"@/utils/auth\"; // get token from cookie\r\nimport getPageTitle from \"@/utils/get-page-title\";\r\n\r\nNProgress.configure({ showSpinner: false }); // NProgress Configuration\r\n\r\nconst whiteList = [\"/login\"]; // no redirect whitelist\r\n\r\nrouter.beforeEach(async (to, from, next) => {\r\n  // start progress bar\r\n  NProgress.start();\r\n\r\n  // set page title\r\n  document.title = getPageTitle(to.meta.title);\r\n\r\n  // determine whether the user has logged in\r\n  const hasToken = getToken();\r\n\r\n  if (hasToken) {\r\n    if (to.path === \"/login\") {\r\n      // if is logged in, redirect to the home page\r\n      next({ path: \"/\" });\r\n      NProgress.done();\r\n    } else {\r\n      const hasGetUserInfo = store.getters.name;\r\n      if (hasGetUserInfo) {\r\n        next();\r\n      } else {\r\n        try {\r\n          // get user info\r\n          await store.dispatch(\"user/getInfo\");\r\n\r\n          next();\r\n        } catch (error) {\r\n          // remove token and go to login page to re-login\r\n          await store.dispatch(\"user/resetToken\");\r\n          Message.error(error || \"Has Error\");\r\n          next(`/login?redirect=${to.path}`);\r\n          NProgress.done();\r\n        }\r\n      }\r\n    }\r\n  } else {\r\n    /* has no token*/\r\n\r\n    // if (whiteList.indexOf(to.path) !== -1) {\r\n    //   // in the free login whitelist, go directly\r\n    //   next()\r\n    // } else {\r\n    //   // other pages that do not have permission to access are redirected to the login page.\r\n    //   next(`/login?redirect=${to.path}`)\r\n    //   NProgress.done()\r\n    // }\r\n    if (to.path.includes(\"/admin\")) {\r\n      next(`/login?redirect=${to.path}`);\r\n      NProgress.done();\r\n    } else {\r\n      next();\r\n    }\r\n  }\r\n});\r\n\r\nrouter.afterEach(() => {\r\n  // finish progress bar\r\n  NProgress.done();\r\n});\r\n"],"mappings":"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"}]}